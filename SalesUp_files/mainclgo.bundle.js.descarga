clgoJsonp([1,5],{0:function(module,exports,__webpack_require__){eval("'use strict';\n\nvar _utility = __webpack_require__(33);\n\nvar _layout = __webpack_require__(34);\n\nvar _layout2 = _interopRequireDefault(_layout);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n(function () {\n  var disableGA = false;\n  var metaViewportUtils = __webpack_require__(35);\n  var widgetLayoutBuilder = __webpack_require__(36);\n\n  var jQueryLdk = null;\n\n  loadJavascript('//d47r8x2gwo1do.cloudfront.net/public/javascripts/jquery-2.2.3.min.js', myJQueryCode, true);\n\n  function loadJavascript(src, onload, async) {\n    var headTag = document.getElementsByTagName('head')[0];\n    var jqTag = document.createElement('script');\n    jqTag.type = 'text/javascript';\n    jqTag.src = src;\n    jqTag.onload = onload;\n    jqTag.async = true;\n    headTag.appendChild(jqTag);\n  }\n\n  function myJQueryCode() {\n    // Solo en 2 lugares uso jQuery puro (lugar 2)\n    jQueryLdk = $.noConflict(true);\n    initMainClgo(jQueryLdk);\n  }\n\n  // Trackeo si hay un lead por enviar en localstorage\n  window.reSendLocalStorage = function () {\n    if (window.Leadaki) {\n      asyncTrackLeadFromBuffer();\n    } else {\n      setTimeout('reSendLocalStorage()', 1000);\n    }\n  };\n\n  window.asyncTrackLeadFromBuffer = function () {\n\n    if (localStorage.getItem('_ldkTrackLead')) {\n\n      jQueryLdk.ajax({\n        type: 'POST',\n        url: 'https://convergency.herokuapp.com/Siteless/contactSave',\n        data: localStorage.getItem('_ldkTrackLead'),\n        //eliminar del localstorage cuando vuelva el ajax\n        success: function success(data) {\n          localStorage.removeItem('_ldkTrackLead');console.log('form successfully sent');\n        },\n        //eliminar del localstorage cuando vuelva el ajax\n        error: function error(jqXHR, textStatus, errorThrown) {\n          return console.log('Error al enviar formulario:', jqXHR, textStatus, errorThrown);\n        },\n        dataType: 'jsonp'\n      });\n\n      trackGAEvent('Form', 'Conversion');\n      fireNewLeadPixels();\n    }\n  };\n\n  window.isValidContactForm = function (form) {\n\n    function find(form) {\n      var retValue = jQueryLdk(form).find('input').filter(function () {\n        return this.value && this.name.match(/(mail|phone|tel)/i);\n      }).length > 0;\n      return retValue;\n    }\n\n    return jQueryLdk(form).find('input[type=\"password\"]').size() > 0 ? false // no formularios que tenga campos tipo password\n    : find(form);\n  };\n\n  window.clearFormHooksBuffer = function () {\n    localStorage.removeItem('_ldkTrackLead');\n  };\n\n  window.serializeForm = function (company, website) {\n    return jQueryLdk('form').serialize() + '&channel=FORM&ldkCompanyId=' + company + '&ldkWebsiteId=' + website + '&ldkRefererTracking=';\n  };\n\n  window.fireNewLeadPixels = function () {\n    var oldDocWrite = document.write;\n    document.write = function (node) {\n      return jQueryLdk('body').append(node);\n    };\n\n    jQueryLdk('body').append(Leadaki.conversionPixels); //pasar a mayúsculas!\n\n    setTimeout(function () {\n      return document.write = oldDocWrite;\n    }, 5000);\n  };\n\n  window.ldkTrackContactFormSerialized = function (formSerialized) {\n    var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n    var clgoScript = document.querySelector('script[id=\"mainclgo\"]');\n    var companyId = clgoScript.getAttribute('data-company-id');\n    var sourceId = clgoScript.getAttribute('data-source-id');\n\n    var url = 'https://convergency.herokuapp.com/Siteless/contactSave';\n    var data = formSerialized + '&channel=FORM' + '&ldkCompanyId=' + companyId + '&ldkWebsiteId=' + sourceId + '&ldkRefererTracking=' + encodeURIComponent(readCookie('ldkRefererTracking')) + addUtmsParam() + addCustomLeadData();\n\n    var req = new XMLHttpRequest();\n    req.open('POST', url, true);\n    req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\n    req.onreadystatechange = cbDone;\n    req.send(data);\n\n    // TODO: ESTE CB ES HORRIBLE, mejorarlo.\n    // https://developer.mozilla.org/es/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest\n    function cbDone(event) {\n      if (req.readyState === 4 && req.status === 200) {\n        window.trackGAEvent({ category: 'Form', action: 'Conversion' });\n        window.trackGAEvent({ category: 'Form', action: 'Convertion' }); //deprecado: mantenido por compatiblildad\n        window.fireNewLeadPixels();\n\n        if (typeof callback === 'function') {\n          callback();\n        } else {\n          eval(callback);\n        }\n      }\n    }\n\n    function readCookie(name) {\n      var nameEQ = name + '=';\n      var ca = document.cookie.split(';');\n      var i = ca.length;\n      while (i--) {\n        var c = ca[i];\n        while (c.charAt(0) === ' ') {\n          c = c.substring(1, c.length);\n        }if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\n      }\n      return null;\n    }\n\n    function addCustomLeadData() {\n      return window.Leadaki.customAttributes ? '&customAttributes=' + encodeURIComponent(window.Leadaki.customAttributes) : null;\n    }\n\n    function addUtmsParam() {\n      return readCookie('ldkUtms') ? '&ldkUtms=' + encodeURIComponent(readCookie('ldkUtms')) : '';\n    }\n  };\n\n  window.ldkTrackContact = function (formSelector, successCallback) {\n    ldkTrackContactFormSerialized(jQueryLdk(formSelector).serialize(), successCallback);\n  };\n\n  // NO BORRAR EL DUPLICADO\n  window.addUtmsParam = function () {\n    return readCookie('ldkUtms') ? '&ldkUtms=' + encodeURIComponent(readCookie('ldkUtms')) : '';\n  };\n\n  // Cookies handling NO BORRAR EL DUPLICADO\n  window.readCookie = function (name) {\n    var nameEQ = name + '=';\n    var ca = document.cookie.split(';');\n    var i = ca.length;\n    while (i--) {\n      var c = ca[i];\n      while (c.charAt(0) === ' ') {\n        c = c.substring(1, c.length);\n      }if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\n    }\n    return null;\n  };\n\n  window.initGA = function (config) {\n    // If user disabled ga, dont initialize\n    if (config.labs.disable_ga) {\n      disableGA = true;\n      return;\n    }\n    (function (i, s, o, g, r, a, m) {\n      i['GoogleAnalyticsObject'] = r;\n      i[r] = i[r] || function () {\n        (i[r].q = i[r].q || []).push(arguments);\n      }, i[r].l = 1 * new Date();\n      a = s.createElement(o), m = s.getElementsByTagName(o)[0];\n      a.async = 1;\n      a.src = g;\n      m.parentNode.insertBefore(a, m);\n    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');\n\n    var LEADAKI_GA_ID = 'UA-28791515-1'; // Leadaki landings (producción)\n    var LEADAKI_GA_ID_TEST = 'UA-28791515-5';\n\n    //https://developers.google.com/analytics/devguides/collection/analyticsjs/advanced#multipletrackers\n    //Creo un tracker si lo pusieron por configuración con el ID de Google Analytics en el website\n    if (config.googleAnalyticsId) {\n      ga('create', config.googleAnalyticsId, 'auto');\n    }\n\n    //Creo siempre un tracker exclusivo para Leadaki\n    ga('create', LEADAKI_GA_ID, 'auto', { 'name': 'leadakiTracker' });\n\n    // track de custom dimensions  https://developers.google.com/analytics/devguides/collection/analyticsjs/custom-dims-mets?hl=es-419\n    ga('leadakiTracker.set', {\n      'dimension1': 'Pilar_1.0', //TipoRobot\n      'dimension2': 'Web_2.0', //TipoChatView\n      'dimension3': config.chatbotName, //BotName\n      'dimension4': config.chatWindowTitle, //TituloChatView\n      'dimension5': config.chatSaluteTimeInSeconds, //ChatSaluteTime\n      'dimension6': config.chatWindowColor, //ColorChatView\n      'dimension7': Object.keys(config.labs || {}).join() || 'Not set', //Labs Website\n      'dimension8': config.companyLabs || 'Not set', //Labs Company\n      'dimension9': config.planType,\n      'dimension10': config.vertical || 'Not set' //CompanyIndustry\n    });\n\n    //Le mando sólo al tracker de leadaki el pageview con la estructura rara de urls\n    ga('send', 'pageview');\n    ga('leadakiTracker.send', 'pageview', '/cliente/' + config.companyId + '/siteless/' + config.websiteId + '/' + encodeURIComponent(window.location.href));\n\n    if (config.googleAdWordsConversionId && config.automaticRemarketingEnabled) {\n      var pixel = document.createElement('img');\n      pixel.src = '//googleads.g.doubleclick.net/pagead/viewthroughconversion/' + config.googleAdWordsConversionId + '/?value=0&amp;guid=ON&amp;script=0';\n      pixel.height = 1;\n      pixel.width = 1;\n      pixel.style.borderStyle = 'none';\n      pixel.style.display = 'none';\n      // console.log('Firing automatic Remarketing Pixel for Id ' + config.googleAdWordsConversionId);\n      document.body.appendChild(pixel);\n    }\n  };\n\n  window.trackGAEvent = function (eventData) {\n    if (disableGA) {\n      // If user disabled ga, dont initialize\n      return;\n    }\n    'use strict';\n    // console.log('tracking GA event:', eventData);\n    var category = eventData.category;\n    var action = eventData.action;\n    var label = eventData.label;\n    var value = eventData.value;\n\n    if (window.gtag) {\n      window.gtag('event', action, {\n        'event_category': category,\n        'event_label': label,\n        'value': value\n      });\n    }\n\n    if (window.gaq) {\n      gaq.push(['_trackEvent', category, action, label, value]);\n    }\n    //Soporte para https://developers.google.com/analytics/devguides/collection/gajs/\n    if (window._gaq) {\n      _gaq.push(['_trackEvent', category, action, label, value]);\n    }\n    if (window.ga) {\n      ga('leadakiTracker.send', 'event', category, action, label, value, { nonInteraction: true }); // para el tracker de leadaki\n      ga('send', 'event', category, action, label, value, { nonInteraction: true }); //para el tracker normal de GA\n\n      // para el tracker Google Tag Manager\n      try {\n        var gaTrackers = ga.getAll();\n        // itero los trackers de Google Analytics que se configura automáticos con GTM\n        var i = gaTrackers.length;\n        while (i--) {\n          var trackerName = gaTrackers[i].get('name');\n          if (trackerName.startsWith('gtm')) {\n            ga(trackerName + '.send', 'event', category, action, label, value);\n          }\n        }\n      } catch (e) {\n        //nada porque es error de GTM\n      }\n    }\n\n    if (window.dataLayer) {\n      dataLayer.push({ event: action });\n    }\n\n    //track para hotjar\n    if (window.hj) {\n      hj('tagRecording', [category, action]);\n    }\n  };\n\n  // Track leadaki-only events\n  window.trackLeadakiEvent = function (eventData) {\n    if (window.ga) {\n      var category = eventData.category;\n      var action = eventData.action;\n      var label = eventData.label;\n      var value = eventData.value;\n\n      ga('leadakiTracker.send', 'event', category, action, label, value, { nonInteraction: true }); // para el tracker de leadaki\n    }\n  };\n\n  function initMainClgo($) {\n    console.log('Main Cliengo loaded');\n\n    var eventMethod = window.addEventListener ? 'addEventListener' : 'attachEvent';\n    var eventer = window[eventMethod];\n    var messageEvent = eventMethod === 'attachEvent' ? 'onmessage' : 'message';\n    var WIDGET_STATUS_CLOSED = 'widget_closed';\n    var WIDGET_STATUS_OPEN = 'widget_open';\n    var USER_INTERACTED_COOKIE = 'userInteracted';\n\n    var clgoScript = document.querySelector('#mainclgo');\n    var companyId = clgoScript.getAttribute('data-company-id');\n    var sourceId = clgoScript.getAttribute('data-source-id');\n    var src = clgoScript.getAttribute('src');\n    var thirdSlash = src.split('/', 3).join('/').length;\n    var host = clgoScript.getAttribute('data-host');\n    var ldkRefererTracking = void 0;\n    var ldkUtms = void 0;\n    var clgoDiv = void 0;\n    var chatIframe = void 0;\n    var popupIframe = void 0;\n    var widgetStatus = WIDGET_STATUS_CLOSED;\n    var sessionPath = '/s/' + companyId + '/' + sourceId;\n\n    var layout = widgetLayoutBuilder.buildChatLayout(companyId, sourceId, host, window.Cliengo);\n    document.body.appendChild(layout.clgoDiv);\n\n    clgoDiv = layout.clgoDiv;\n    chatIframe = layout.chatIframe;\n    popupIframe = layout.popupIframe;\n\n    //seteo cookie de referer\n    if (readCookie('ldkRefererTracking') === null) {\n      createCookie('ldkRefererTracking', document.referrer ? document.referrer : 'direct', 240);\n    }\n\n    //seteo cookie de utms\n    if (location.search.indexOf('utm_') !== -1 || location.search.indexOf('gclid') !== -1) {\n      var utmCookie = '';\n      utmCookie += addIfParameterExists('utm_source');\n      utmCookie += addIfParameterExists('utm_medium');\n      utmCookie += addIfParameterExists('utm_term');\n      utmCookie += addIfParameterExists('utm_content');\n      utmCookie += addIfParameterExists('utm_campaign');\n      utmCookie += addIfParameterExists('utm_adgroup');\n      utmCookie += addIfParameterExists('gclid');\n      createCookie('ldkUtms', utmCookie, 240);\n    }\n\n    ldkRefererTracking = readCookie('ldkRefererTracking');\n    ldkUtms = readCookie('ldkUtms');\n\n    function addIfParameterExists(name) {\n      var pValue = getURLParameter(name);\n      return pValue ? '&' + name + '=' + pValue : '';\n    }\n\n    function getURLParameter(name) {\n      return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || [, ''])[1].replace(/\\+/g, '%20')) || null;\n    }\n\n    // Trackeo si hay un lead por enviar en localstorage\n    reSendLocalStorage();\n\n    var configAndCookies = window.cliengoCustoms ? window.cliengoCustoms : {};\n    configAndCookies.ldkRefererTracking = ldkRefererTracking;\n    configAndCookies.ldkUtms = ldkUtms;\n    configAndCookies.url = document.URL;\n    configAndCookies.hostname = document.location.hostname;\n\n    // Track event for Cliengo.config\n    if (window.cliengoCustoms) {\n      trackGAEvent({ category: 'clgo_stats', action: 'custom_settings' });\n    }\n\n    // Listen to message from child window\n    eventer(messageEvent, function (e) {\n      var key = e.message ? 'message' : 'data';\n      var eventData = e[key];\n      processMessage(eventData);\n    }, false);\n\n    function processMessage(eventData) {\n      switch (eventData.type) {\n        case 'WIDGET_OPEN':\n        case 'WIDGET_OPEN_SMALL':\n          widgetStatus = WIDGET_STATUS_OPEN;\n          metaViewportUtils.controlParentPage();\n          removeClass(chatIframe, 'collapsed-height');\n          addClass(chatIframe, 'expanded-height');\n          if (eventData.type === 'WIDGET_OPEN_SMALL') // Open a small chat window\n            addClass(chatIframe, 'fixed-height');\n          addClass(document.body, 'clgo-chat-window-active');\n          popupIframe.style.height = '1px';\n          popupIframe.style.width = '1px';\n          break;\n        case 'WIDGET_REMOVE_SMALL':\n          // Make window higher (with a linear transition)\n          removeClass(chatIframe, 'fixed-height');\n          break;\n        case 'WIDGET_CLOSE':\n          widgetStatus = WIDGET_STATUS_CLOSED;\n          metaViewportUtils.returnControlToParentPage();\n          chatIframe.style.width = '93px';\n          removeClass(chatIframe, 'expanded-height');\n          removeClass(document.body, 'clgo-chat-window-active');\n          addClass(chatIframe, 'collapsed-height');\n\n          popupIframe.style.height = '1px';\n          popupIframe.style.width = '1px';\n          break;\n        case 'POPUP_CLOSE':\n          chatIframe.contentWindow.postMessage(eventData, '*');\n          popupIframe.style.height = '1px';\n          popupIframe.style.width = '1px';\n          break;\n        case 'WIDGET_SHOW_POPUP':\n          chatIframe.style.width = '93px';\n          chatIframe.style.height = '86px';\n          popupIframe.contentWindow.postMessage(eventData, '*');\n          break;\n        case 'WIDGET_HIDE_POPUP':\n          chatIframe.style.width = '93px';\n          chatIframe.style.height = '86px';\n          popupIframe.style.height = '1px';\n          popupIframe.style.width = '1px';\n          popupIframe.contentWindow.postMessage(eventData, '*');\n          break;\n        case 'WIDGET_READY':\n          clgoDiv.style.display = 'block';\n          chatIframe.style.height = '86px';\n          chatIframe.style.width = '93px';\n          window.Leadaki = eventData.data;\n          var customConfig = {\n            type: 'CONFIGS',\n            data: JSON.stringify(configAndCookies)\n          };\n          chatIframe.contentWindow.postMessage(customConfig, '*');\n          reSendLocalStorage();\n          break;\n        case 'RESIZE_POPUP_FRAME':\n          if (widgetStatus === WIDGET_STATUS_CLOSED) {\n            popupIframe.style.width = '100%';\n            popupIframe.style.height = eventData.height;\n          }\n          break;\n        case 'POPUP_CLICKED':\n          chatIframe.contentWindow.postMessage(eventData, '*');\n          break;\n        case 'HIDE_SECOND_IFRAME':\n          popupIframe.style.display = 'none';\n          break;\n        case 'GA_INIT':\n          initGA(eventData.data);\n          break;\n        case 'GA_TRACK_EVENT':\n          trackGAEvent(eventData.data);\n          break;\n        case 'GA_LEADAKI_TRACK_EVENT':\n          trackLeadakiEvent(eventData.data);\n          break;\n        case 'WIDGET_FIRE_PIXELS':\n          fireNewLeadPixels(eventData.data, $);\n          break;\n        default:\n          break;\n      }\n    }\n\n    function hasClass(el, className) {\n      return el.classList ? el.classList.contains(className) : !!el.className.match(new RegExp('(\\\\s|^)' + className + '(\\\\s|$)'));\n    }\n\n    function addClass(el, className) {\n      if (el.classList) {\n        el.classList.add(className);\n      } else if (!hasClass(el, className)) el.className += ' ' + className;\n    }\n\n    function removeClass(el, className) {\n      if (el.classList) {\n        el.classList.remove(className);\n      } else if (hasClass(el, className)) {\n        var reg = new RegExp('(\\\\s|^)' + className + '(\\\\s|$)');\n        el.className = el.className.replace(reg, ' ');\n      }\n    }\n\n    $('form').on('submit', function (e) {\n      if (Leadaki.formHooksEnabled && isValidContactForm(this)) {\n        //guardar en el localstorage\n        var utmParamStorage = addUtmsParam();\n        var _encodeURIComponent = readCookie(ldkRefererTracking);\n        var serialized = serializeForm(companyId, sourceId);\n\n        localStorage.setItem('_ldkTrackLead', serialized + _encodeURIComponent + utmParamStorage);\n\n        //hago la llamada 1 seg más tarde, a ver si lo puede hacer en la misma página\n        setTimeout('asyncTrackLeadFromBuffer()', 1000);\n      }\n    });\n\n    // Cookies handling\n    function readCookie(name) {\n      var nameEQ = name + '=';\n      var ca = document.cookie.split(';');\n      var i = ca.length;\n      while (i--) {\n        var c = ca[i];\n        while (c.charAt(0) === ' ') {\n          c = c.substring(1, c.length);\n        }if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\n      }\n      return null;\n    }\n\n    function createCookie(name, value, minutes) {\n      var expires = '';\n      if (minutes) {\n        var date = new Date();\n        date.setTime(date.getTime() + minutes * 60 * 1000);\n        expires = '; expires=' + date.toGMTString();\n      }\n      document.cookie = name + '=' + value + expires + '; path=;';\n    }\n  }\n\n  /**\n   * envio datos de navegacion de chat-iframe\n   */\n  setTimeout(function () {\n    var newPoint = {\n      navHistory: {\n        hostname: window.location.hostname,\n        search: window.location.search,\n        pathname: window.location.pathname,\n        origin: window.location.origin,\n        date: new Date() // TODO: esto deberia venir del server\n      }\n    };\n\n    document.getElementById('chatIframe').contentWindow.postMessage(JSON.stringify(newPoint), '*');\n  }, 3000); // 3 segundos para evitar el rebote.\n\n})();\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/main-clgo.js\n// module id = 0\n// module chunks = 1\n//# sourceURL=webpack:///./client/main-clgo.js?")},33:function(module,exports){eval("'use strict';\nexports.Utility = {\n    addMinutes: function (date, minutes) {\n        return new Date(date.getTime() + minutes * 60000);\n    },\n    /** determine is device is mobile or not\n     * @return {boolean} true if device is mobile\n     */\n    IsMobileDevice: function () { return (navigator && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)); },\n    /**\n     * resize chat body\n     */\n    ResizeChatBody: function () {\n        var widgetHeight = window.innerHeight;\n        var topbarHeight = document.getElementById('topbar').offsetHeight;\n        var userInputHeight = document.getElementById('user-input').offsetHeight;\n        var msgWindowHeight = widgetHeight - (topbarHeight + userInputHeight);\n        var msgWindow = document.getElementById('messages-window');\n        msgWindow.style.height = msgWindowHeight + 'px';\n        msgWindow.style.maxHeight = msgWindowHeight + 'px';\n    },\n    /**\n     * Set the \"You\" word based on user langage\n     * @param {string} userLang idioma configurado por el usuario\n     * @return {string}\n     */\n    SetYou: function (userLang) {\n        if (['ar', 'es', 'es_AR', 'es_ES'].includes(userLang)) {\n            return 'Tú';\n        }\n        else if (userLang === 'en') {\n            return 'You';\n        }\n        else if (userLang === 'pt') {\n            return 'Você';\n        }\n        return 'You';\n    },\n    /**\n     * Funcion para simular el seteo de las cookies en localstorage cuando el widget corre en Safari. Esto lo usamos\n     * porq Safari no permite setear cookies crossdomain.\n     * @param name\n     * @param value\n     * @param minutes\n     */\n    SetLocalStorageItem: function (name, value, minutes, path, url) {\n        if ('localStorage' in window) {\n            var s = {\n                value: value,\n                expiration: exports.Utility.addMinutes(new Date(), minutes),\n                url: url,\n                path: path\n            };\n            localStorage.setItem(name + s.url + s.path, JSON.stringify(s));\n        }\n    },\n    /**\n     * Funcion para simular el geteo de las cookies en localstorage cuando el widget corre en Safari. Esto lo usamos\n     * porq Safari no permite setear cookies crossdomain.\n     * @param name\n     * @param {object} widget\n     * @returns {null}\n     */\n    GetLocalStorageItem: function (name, widget) {\n        if ('localStorage' in window) {\n            var storageStr = localStorage.getItem(name + widget.chatConfig.url + widget.chatConfig.sessionPath);\n            if (!storageStr) {\n                return null;\n            }\n            var storageObj = JSON.parse(storageStr);\n            var now = new Date();\n            var expireDate = new Date(storageObj.expiration);\n            // si expiro la 'cookie' de localstorage, la borro y y devuelvo null.\n            if (now > expireDate) {\n                localStorage.removeItem(name);\n                return null;\n            }\n            // si existe y no expiro, la devuelvo.\n            return storageObj.value;\n        }\n        return null;\n    },\n    EmmitIframeEvent: function (type, data) {\n        if (data === void 0) { data = null; }\n        window.parent.postMessage({ type: type, data: data }, '*');\n    },\n    /**\n     * parsea el mensaje a ver si tiene respuestas rapidas\n     * Si las tiene, crea el array con las respuestas rapidas y trunca el texto del mensaje\n     * @param {object} message\n     * @return {object} devuelve el nuevo objeto del mensaje con la propiedad \"quickReplies\"\n     * que es un array de textos.\n     */\n    GetQuickReplies: function (message) {\n        var messageText = message.content;\n        var pattern = /(.*)\\[\\[([\\-\\!\\?a-zA-Z0-9À-ÿ\\s,\\.]*)\\]\\]/;\n        if (!pattern.test(message.content))\n            return { messageText: messageText, quickReplies: [] };\n        var matches = message.content.match(pattern);\n        messageText = matches[1]; // elimino opciones del string del mensaje\n        var quickReplies = matches[2].split(',');\n        quickReplies.filter(function (item) { return item.trim() !== \"\"; });\n        var choicesLength = quickReplies.length;\n        if (choicesLength === 0) {\n            quickReplies.length = 0;\n        }\n        return { messageText: messageText, quickReplies: quickReplies };\n    }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/utils/utility.ts\n// module id = 33\n// module chunks = 1 4\n//# sourceURL=webpack:///./client/utils/utility.ts?")},34:function(module,exports){eval("'use strict';\n\nmodule.exports = {\n    mainDiv: {\n        position: 'fixed',\n        bottom: 0,\n        display: 'none',\n        height: '1px',\n        width: '1px',\n        zIndex: '9999998'\n    },\n    popupIframe: {\n        zIndex: '1999998',\n        backgroundColor: 'transparent',\n        border: 'none',\n        width: '1px',\n        maxWidth: '240px',\n        height: '1px',\n        position: 'fixed',\n        right: '0',\n        bottom: '85px'\n    },\n    chatIframe: {\n        zIndex: '1999999',\n        backgroundColor: 'transparent',\n        border: 'none',\n        width: '1px',\n        height: '1px',\n        maxWidth: '360px',\n        position: 'fixed',\n        right: '15px',\n        bottom: '0'\n    }\n\n};\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/config/layout.js\n// module id = 34\n// module chunks = 1\n//# sourceURL=webpack:///./client/config/layout.js?")},35:function(module,exports){eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar originalViewport = void 0;\nvar clgoMetaViewportContent = 'width=device-width, initial-scale=1';\n\nvar createViewportMeta = function createViewportMeta() {\n  var viewPortTag = document.createElement('meta');\n  viewPortTag.id = 'viewport';\n  viewPortTag.name = 'viewport';\n  viewPortTag.content = clgoMetaViewportContent;\n  document.getElementsByTagName('head')[0].appendChild(viewPortTag);\n};\n\nvar storeOriginalViewportMeta = function storeOriginalViewportMeta() {\n  var viewports = document.querySelector('head').querySelector('[name=viewport]');\n  originalViewport = viewports.content;\n};\n\nvar setMetaViewportContent = function setMetaViewportContent(content) {\n  var metaViewport = document.querySelector('head').querySelector('[name=viewport]');\n  metaViewport.content = content;\n};\n\nvar removeMetaViewportElement = function removeMetaViewportElement() {\n  var head = document.querySelector('head');\n  head.removeChild(head.querySelector('[name=viewport]'));\n};\n\nvar controlParentPage = exports.controlParentPage = function controlParentPage() {\n  if (!document.querySelector('head').querySelector('[name=viewport]')) {\n    createViewportMeta();\n  } else {\n    storeOriginalViewportMeta();\n    setMetaViewportContent(clgoMetaViewportContent);\n  }\n};\n\nvar returnControlToParentPage = exports.returnControlToParentPage = function returnControlToParentPage() {\n  return originalViewport ? setMetaViewportContent(originalViewport) : removeMetaViewportElement();\n};\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/utils/meta-viewport.js\n// module id = 35\n// module chunks = 1\n//# sourceURL=webpack:///./client/utils/meta-viewport.js?")},36:function(module,exports,__webpack_require__){eval("'use strict';\n\nvar _layout = __webpack_require__(34);\n\nvar _layout2 = _interopRequireDefault(_layout);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * detiene interacciones ui del usuario\n */\nfunction stopPropagationListeners(chatIframe) {\n    function bubbleResponsive(e) {\n        e.stopPropagation();\n    }\n\n    chatIframe.addEventListener('scroll', bubbleResponsive);\n    chatIframe.addEventListener('resize', bubbleResponsive);\n    chatIframe.addEventListener('touchstart', bubbleResponsive);\n    chatIframe.addEventListener('touchmove', bubbleResponsive);\n    chatIframe.addEventListener('touchend', bubbleResponsive);\n    chatIframe.addEventListener('touchcancel', bubbleResponsive);\n    chatIframe.addEventListener('touchforcechange', bubbleResponsive);\n    chatIframe.addEventListener('gesturestart', bubbleResponsive);\n    chatIframe.addEventListener('gesturechange', bubbleResponsive);\n    chatIframe.addEventListener('gestureend', bubbleResponsive);\n}\n\n/**\n * Construye el chat\n * @param companyId\n * @param sourceId\n */\n/**\n * Created by pablo on 8/11/17.\n */\n\nfunction buildChatLayout(companyId, sourceId, host, Cliengo) {\n    'use strict';\n\n    function createIframe(attrs, styles, appendTo) {\n        var iframe = document.createElement('iframe');\n        iframe.ALLOWTRANSPARENCY = true;\n        iframe.allowtransparency = true;\n        iframe.allowFullScreen = true;\n        iframe.allowFullscreen = true;\n\n        for (var attr in attrs) {\n            iframe[attr] = attrs[attr];\n        }\n\n        // seteo estilos\n        for (var prop in styles) {\n            iframe.style[prop] = styles[prop];\n        }\n\n        if (typeof iframe.mozRequestFullScreen === 'function') {\n            iframe.mozRequestFullScreen();\n        }\n\n        if (typeof iframe.webkitRequestFullScreen === 'function') {\n            iframe.webkitRequestFullScreen();\n        }\n\n        appendTo.appendChild(iframe);\n\n        return iframe;\n    }\n\n    var styles = '\\n        /* \\n        .clgo-chat-window-active {\\n            overflow: hidden;\\n            height: 100%;\\n            width: 100%;\\n            position: fixed\\n        }\\n        */\\n\\n        .collapsed-height {\\n            height: 86px !important;\\n            right: 15px !important;\\n            display: block !important;\\n        }\\n\\n        .expanded-height {\\n            max-width: 100% !important;\\n            width: 100% !important;\\n            height: 100% !important;\\n            max-height: 100vh;\\n            right: 0 !important;\\n            transition: height 600ms;\\n        }\\n        \\n        iframe.fixed-height {\\n          height: 450px !important;\\n        }\\n\\n        @media (max-width: 767px) {\\n            .clgo-chat-window-active {\\n                overflow: hidden;\\n                height: 100%;\\n                width: 100%;\\n                position: fixed\\n            }\\n        }\\n\\n        @media (min-width: 768px) {\\n            .expanded-height {\\n                max-width: 320px !important;\\n                height: 80% !important; \\n                right: 15px !important;\\n                border-radius: 7px 7px 0 0;\\n            }\\n        }\\n\\n        @media (min-width: 992px) {\\n            .expanded-height {\\n                max-width: 320px !important;\\n                height: 70% !important;\\n                right: 15px !important;\\n                border-radius: 7px 7px 0 0;\\n            }\\n        }\\n    ';\n\n    var builderHost = host || 'https://w.cliengo.com';\n\n    var divExists = document.querySelector('div[id=\"clgo\"]');\n\n    // creo el div si no existe\n    var clgoDiv = divExists || document.createElement('div');\n    clgoDiv.innerHTML = '';\n    clgoDiv.id = 'clgo';\n\n    // seteo estilos\n    for (var prop in _layout2.default.mainDiv) {\n        clgoDiv.style[prop] = _layout2.default.mainDiv[prop];\n    }\n\n    var clgoStyle = document.createElement('style');\n    clgoStyle.innerHTML = styles;\n    document.head.appendChild(clgoStyle);\n\n    var popupIframeAttrs = {\n        id: 'popupIframe',\n        src: builderHost + '/s/' + companyId + '/' + sourceId + '/popup-iframe'\n    };\n    var popupIframe = createIframe(popupIframeAttrs, _layout2.default.popupIframe, clgoDiv);\n\n    var chatConfig = '';\n    try {\n        chatConfig = '#' + encodeURIComponent(JSON.stringify(Cliengo.chatConfig));\n    } catch (err) {}\n\n    var chatIframeAttrs = {\n        id: 'chatIframe',\n        src: builderHost + '/s/' + companyId + '/' + sourceId + chatConfig,\n        className: 'collapsed-height'\n    };\n    var chatIframe = createIframe(chatIframeAttrs, _layout2.default.chatIframe, clgoDiv);\n\n    stopPropagationListeners(chatIframe);\n\n    return {\n        clgoDiv: clgoDiv,\n        chatIframe: chatIframe,\n        popupIframe: popupIframe\n    };\n}\n\nmodule.exports = { buildChatLayout: buildChatLayout };\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/utils/layout-builder.js\n// module id = 36\n// module chunks = 1\n//# sourceURL=webpack:///./client/utils/layout-builder.js?");}});